<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title> EDAV Project</title>
    <script src="https://d3js.org/d3.v7.js">  </script>
    <style>
      * {
        font-family: sans-serif;
      }
      text {
        font-size: 12px;
      }
    </style>
  </head>
  <body>
    <div>
      <h3>Title </h3>
      <p>Some text</p>
      
      <input type="radio" name="Position" value="All" checked="true">No Position Filter
      <input type="radio" name="Position" value="Def">Defenders
      <input type="radio" name="Position" value="Mid">Midfielders
      <input type="radio" name="Position" value="Fwd">Forwards
      
      
    </div>
    <script type="text/javascript">
      
      //Width and height
      const w = 700;
      const h = 300;
      const margin = {top: 25, right: 100, bottom: 50, left: 100};
      const innerHeight = h - margin.top - margin.bottom;
      const innerWidth = w - margin.left - margin.right;

      d3.csv("https://raw.githubusercontent.com/ss16318/FantasyPremierLeaguePlayerValue/main/Data/d3Data.csv").then(function(dataset) {
        
        console.log(dataset);
        
        dataset.forEach(d => d.Cost = d.Cost / 1000000);
    
    
        // ADD: create scales
        
        const xScale = d3.scaleLinear()
          .domain([d3.min(dataset.map( d => d.Cost)), d3.max(dataset.map( d=> d.Cost))])               
          .range([0, innerWidth])
          
  
        const yScale = d3.scaleLinear()
          .domain([d3.max(dataset.map( d => d.TotalPoints)), d3.min(dataset.map( d=> d.TotalPoints))]) 
          .range([0, innerHeight])
          
          
        // ADD: create axis generators
        const xAxis = d3.axisBottom()
          .scale(xScale);
  
        const yAxis = d3.axisLeft()
          .scale(yScale);
          
  
        // ADD: create SVG element
  
        const svg = d3.select("body")
          .append("svg")
          .attr("width", w)
          .attr("height", h);
            
        // ADD: background rectangle
        
        svg.append("rect")
          .attr("x", "0")
          .attr("y", "0")
          .attr("width", w)
          .attr("height", h)
          .attr("fill", "aliceblue");
  
      
  
        // create caption
        d3.select("body")
          .append("div")
          .style("padding", "10px")
          .append("a")
          .attr("href", "https://www.weather.gov/documentation/services-web-api")
          .text("A hyperlink");
  
        // ADD: create plot group
        
        svg.append("g")
          .attr("id", "plot")
          .attr("transform", `translate (${margin.left}, ${margin.top})`);

  
        // ADD: create circles
        svg.select("g#plot")     
          .selectAll("circle")    
          .data(dataset)          
          .enter()               
          .append("circle")
          .attr("cx", d => xScale(d.Cost))
          .attr("cy", d => yScale(d.TotalPoints))
          .attr("r", 2)
          .attr("fill", "black")
          .attr("id" , d => d.PositionsList)
          .classed("Pos" , d => d.PositionsList)
          .on("mouseover", function(event, d) {
            //var xcoord = d3.select(event.currentTarget).attr("cx") + 5
            //var ycoord = d3.select(event.currentTarget).attr("cy") - 5
            svg.select("g#plot")
            .append("text")
            .attr("id", "tooltip")
            .attr("x", 10)
            .attr("y", 10)
            .style('fill', 'Black')
            .text( "Name: " + d.Surname + " (" + d.Season + " Season)")
            
            
          })
          .on("mouseout", function() {
            d3.select("#tooltip").remove();
            
          }
          );
            



        // ADD: create x-axis
        
        svg.select("g#plot")
          .append("g")
          .attr("id", "xaxis")
          .attr("transform", `translate (0, ${innerHeight})`)
          .call(xAxis);
          
        // ADD: create y-axis
  
        svg.select("g#plot")
          .append("g")
          .attr("id", "yaxis")
          .call(yAxis);
  
        // ADD: create x-axis label
        
        svg.select("g#plot")
          .append("text")
          .attr("id", "xlab")
          .attr("x", innerWidth / 2)
          .attr("y", innerHeight + .75 * margin.bottom)
          .attr("text-anchor", "middle")
          .text("Cost (Millions)");
          
        // ADD: create y-axis label
        
        svg.select("g#plot")
          .append("text")
          .attr("id", "ylab")
          .attr("x", -70)
          .attr("y", innerHeight / 2)
          .attr("text-anchor", "middle")
          .text("Total Points");
        
        // Radio Button Interactivity
        d3.selectAll("input")
          .on("click", function(event) { 
              
              var Position = event.currentTarget.value; 
              if (Position == "Def") {
                    
              // update cx value of circles
                  svg.selectAll("circle#DEF")
                    .attr("fill", 'red')
                    .attr("r", 2.5)
                    
                  svg.selectAll("circle#MID")
                    .attr("fill", 'black')
                    .attr("r", 2)

                  svg.selectAll("circle#FWD")
                    .attr("fill", 'black')
                    .attr("r", 2)
              }
              
              else if (Position == "Mid") {
                    
              // update cx value of circles
                  svg.selectAll("circle#MID")
                    .attr("fill", 'red')
                    .attr("r", 2.5)

                  svg.selectAll("circle#DEF")
                    .attr("fill", 'black')
                    .attr("r", 2)
                    
                  svg.selectAll("circle#FWD")
                    .attr("fill", 'black')
                    .attr("r", 2)
              }
              
              else if (Position == "Fwd") {
                    
              // update cx value of circles
                  svg.selectAll("circle#FWD")
                    .attr("fill", 'red')
                    .attr("r", 2.5)
                  
                  svg.selectAll("circle#DEF")
                    .attr("fill", 'black')
                    .attr("r", 2)
                  
                  svg.selectAll("circle#MID")
                    .attr("fill", 'black')
                    .attr("r", 2)
              }
              
              else{
                svg.selectAll("circle")
                    .attr("fill", 'black')
                    .attr("r", 2)
              };
                             

          })
                    
        })
          .catch(function(error){
            d3.select("body").append("h3").text("Error loading data.");
            console.log(error);
          });



    </script>
  </body>
</html>
